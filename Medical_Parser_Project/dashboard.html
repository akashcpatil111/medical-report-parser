<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeHealth Doctor Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }
    </style>
</head>

<body class="bg-slate-50 min-h-screen font-sans text-slate-900">

    <nav class="bg-blue-600 text-white p-4 shadow-lg mb-8">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold italic">SafeHealth <span class="font-light text-blue-100">Digitize</span></h1>
            <div class="text-sm bg-blue-700 px-3 py-1 rounded-full">Doctor View: Dr. Smith</div>
        </div>
    </nav>

    <main class="container mx-auto px-4 max-w-4xl">
        <div class="flex flex-col md:flex-row gap-6 mb-8">
            <!-- Patient Info -->
            <div class="glass-card flex-1 p-6 rounded-2xl shadow-sm border border-slate-200">
                <h2 class="text-slate-500 uppercase tracking-widest text-xs font-bold mb-4">Patient Information</h2>
                <div id="patient-name" class="text-2xl font-bold text-blue-900">---</div>
                <div id="report-date" class="text-slate-500 text-sm">Date: ---</div>
            </div>

            <!-- Health Summary Stats -->
            <div class="glass-card flex-1 p-6 rounded-2xl shadow-sm border border-slate-200">
                <h2 class="text-slate-500 uppercase tracking-widest text-xs font-bold mb-4">Alert Status</h2>
                <div id="alert-pill"
                    class="inline-block px-4 py-1 rounded-full text-sm font-bold bg-slate-200 text-slate-600">
                    No Data Loaded
                </div>
            </div>
        </div>

        <!-- Findings Table -->
        <div class="glass-card p-6 rounded-2xl shadow-sm border border-slate-200 mb-8">
            <h2 class="text-slate-500 uppercase tracking-widest text-xs font-bold mb-4">Lab Results Extraction</h2>
            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead>
                        <tr class="border-b border-slate-100">
                            <th class="pb-3 font-semibold text-slate-600">Test</th>
                            <th class="pb-3 font-semibold text-slate-600">Result</th>
                            <th class="pb-3 font-semibold text-slate-600">Unit</th>
                            <th class="pb-3 font-semibold text-slate-600 text-right">Status</th>
                        </tr>
                    </thead>
                    <tbody id="results-table-body">
                        <!-- Rows injected here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Data Input for Demo -->
        <div class="mt-12 bg-slate-800 text-white p-6 rounded-2xl shadow-2xl">
            <h3 class="text-blue-400 font-mono text-sm mb-4 italic">// Demo Controller: Paste JSON from Python output
                below</h3>
            <textarea id="json-input"
                class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 font-mono text-xs text-green-400 h-32 focus:outline-none focus:ring-2 focus:ring-blue-500"
                placeholder='Paste JSON here...'></textarea>
            <button onclick="updateDashboard()"
                class="mt-4 w-full bg-blue-500 hover:bg-blue-400 text-white font-bold py-3 rounded-xl transition-all">
                Sync Dashboard
            </button>
        </div>
    </main>

    <script>
        function updateDashboard() {
            const input = document.getElementById('json-input').value;
            try {
                const data = JSON.parse(input);

                // Update Patient Info
                document.getElementById('patient-name').innerText = data.patient_name || "Unknown Patient";
                document.getElementById('report-date').innerText = "Report Date: " + (data.date || "Unknown");

                // Update Table
                const tbody = document.getElementById('results-table-body');
                tbody.innerHTML = '';

                let hasAlert = false;

                data.tests.forEach(test => {
                    const row = document.createElement('tr');
                    row.className = "border-b border-slate-50 hover:bg-slate-50 transition-colors";

                    const statusColor = test.status === 'High' ? 'text-red-500 font-bold' :
                        test.status === 'Low' ? 'text-orange-500 font-bold' :
                            'text-emerald-500';

                    if (test.status !== 'Normal') hasAlert = true;

                    row.innerHTML = `
                        <td class="py-4 font-medium">${test.test_name}</td>
                        <td class="py-4 text-slate-600">${test.value}</td>
                        <td class="py-4 text-slate-400 text-sm">${test.unit}</td>
                        <td class="py-4 text-right ${statusColor}">${test.status}</td>
                    `;
                    tbody.appendChild(row);
                });

                // Update Alert Pill
                const pill = document.getElementById('alert-pill');
                if (hasAlert) {
                    pill.innerText = "Action Required";
                    pill.className = "inline-block px-4 py-1 rounded-full text-sm font-bold bg-red-100 text-red-600 shadow-sm";
                } else {
                    pill.innerText = "All Clear";
                    pill.className = "inline-block px-4 py-1 rounded-full text-sm font-bold bg-emerald-100 text-emerald-600 shadow-sm";
                }

            } catch (e) {
                alert("Invalid JSON format. Please paste the JSON output from your Python script.");
            }
        }
    </script>
</body>

</html>